install.packages("doBy")
data <- read.csv("activity.csv")
library(doBy)
library(survival)
step_day<-summaryBy(steps ~date, FUN=c(sum), data=data, na.rm=TRUE)
hist(step_day$steps.sum, main = "Total Steps Taken Each Day", col="blue", xlab="Number of Steps")
print(mean_day<-mean(step_day$steps.sum, na.rm=TRUE))
print(median_day<-median(step_day$steps.sum, na.rm=TRUE))
step_interval<-summaryBy(steps ~interval, FUN=c(mean), data=data, na.rm=TRUE)
plot(step_interval$interval, step_interval$steps.mean, type="l", main="Number of Steps Taken Each Interval", xlab="5-minute Interval", ylab="Number of Steps")
print(max_interval<-mean(step_interval$steps.mean, na.rm=TRUE))
print(NAsum<-sum(!complete.cases(data)))
newdata <- transform(data, steps = ifelse(is.na(data$steps), step_interval$steps[match(data$interval, step_interval$interval)], data$steps))
newstep_day<-summaryBy(steps ~date, FUN=c(sum), data=newdata)
hist(newstep_day$steps.sum, main = "Total Steps Taken Each Day", col="blue", xlab="Number of Steps")
hist(step_day$steps.sum, main = "Total Steps Taken Each Day", col="red", xlab="Number of Steps", add=T)
legend("topright", c("No NAs", "With NAs"), col=c("blue", "red"), lwd=10)
print(newmean_day<-mean(newstep_day$steps.sum))
print(newmedian_day<-median(newstep_day$steps.sum))
print(meandifference <- newmean_day-mean_day)
print(meddifference <- newmedian_day-median_day)
newdata$day<-weekdays(as.Date(newdata$date))
newstep_interval <- summaryBy(steps ~interval+day, FUN=c(mean), data=newdata)
View(newstep_interval)
install.packages("car")
library(car)
newstep_interval$day<-recode(newstep_interval$day, "c(Monday, Tuesday, Wednesday, Thursday, Friday)='Weekday'")
str(newstep_interval)
newstep_interval$day<-recode(newstep_interval$day, "c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday')='Weekday'")
View(newstep_interval)
newstep_interval$day<-recode(newstep_interval$day, "c('Saturday', 'Sunday')='Weekend'")
xyplot(newstep_interval$steps.mean ~ newstep_interval$interval|newstep_interval$day, main="Average Steps per Day by Interval",xlab="Interval", ylab="Steps",layout=c(1,2), type="l")
librarlibrary(lattice)
install.packages("lattice")
library(lattice)
xyplot(newstep_interval$steps.mean ~ newstep_interval$interval|newstep_interval$day, main="Average Steps per Day by Interval",xlab="Interval", ylab="Steps",layout=c(1,2), type="l")
View(step_interval)
View(newdata)
View(step_interval)
library(car)
newdata$day<-recode(newdata$day, "c('Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday')='Weekday'")
newdata$day<-recode(newdata$day, "c('Saturday', 'Sunday')='Weekend'")
newstep_interval <- summaryBy(steps ~interval+day, FUN=c(mean), data=newdata)
View(newstep_interval)
library(knitr)
knitr::knit2html("PA1_template.Rmd")
